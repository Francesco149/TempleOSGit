////**************************PROCEDURE*************************
// IN:	 ECX=CLASS
	ALIGN	4,0x90
PUT_CLASS::
	NEG	EAX
	OR	ECX,ECX
	JZ	@@1
	PUSH	EAX
	PUSH	EBX
	PUSH	EDX
	PUSH	ESI
	MOVZX	EBX,BYTE C_PTR_CNT[ECX]
@@10:	OR	EBX,EBX
	JZ	@@20
	MOV	EAX,'*'
	INT	I_PUT_CHAR
	DEC	EBX
	JMP	@@10
@@20:	MOVZX	EAX,BYTE C_PTR_CNT[ECX]
	MOV	EBX,-C_STRUCT_SIZE
	IMUL	EBX
	ADD	EAX,ECX
	MOV	ESI,DWORD C_HASH_STRING[EAX]
	INT	I_PUT_STRING
	MOV	EAX,0x20
	INT	I_PUT_CHAR
	POP	ESI
	POP	EDX
	POP	EBX
	POP	EAX
@@1:	RET
////**************************PROCEDURE*************************
// IN:	 EAX=IC OPCODE
//	 EBX=ARG
//	 ECX=CLASS
//	 EDX=LINE
	ALIGN	4,0x90
PUT_IC::
	CMP	EAX,EC_NOP
	JE	@@1
	PUSH	EAX
	PUSH	ESI
	AND	EAX,0xFF
	LEA	ESI,CODE_TEXT_TABLE[EAX*8]
	INT	I_PUT_STRING
	MOV	EAX,0x20
	INT	I_PUT_CHAR

	MOV	EAX,EBX
	CALL	PUT_HEX
	MOV	EAX,0x20
	INT	I_PUT_CHAR

	MOV	EAX,ECX
	CALL	PUT_HEX
	MOV	EAX,0x20
	INT	I_PUT_CHAR

	MOV	EAX,EDX
	CALL	PUT_HEX
	MOV	EAX,0x20
	INT	I_PUT_CHAR

	CALL	PUT_CLASS
@@1A:	CALL	CRLF
	POP	ESI
	POP	EAX
@@1:	RET
////**************************PROCEDURE*************************
	ALIGN 4,0x90
PUT_ALL_IC::
	PUSHAD
	CALL	CRLF
	CALL	INIT_CB_IN_PTRS
	MOV	ESI,DWORD LEX_CB_IN_PTR[EDI]
	LEA	ESI,DWORD -IC_STRUCT_SIZE[ESI]
@@1B:	ADD	ESI,IC_STRUCT_SIZE
	MOV	EAX,DWORD IC_CODE[ESI]
	OR	EAX,EAX
	JZ	@@1A
	MOV	EBX,DWORD IC_DATA[ESI]
	MOV	ECX,DWORD IC_CLASS[ESI]
	MOV	EDX,DWORD IC_LINE[ESI]
	CALL	PUT_IC
	JMP	@@1B
@@1A:
//	  CALL	  GET_KEY
	POPAD
	RET
////**************************PROCEDURE*************************
	ALIGN	4,0x90
INIT_CB_IN_PTRS::
	MOV	EBX,DWORD LEX_CB_OUT_FIRST[EDI]
	MOV	DWORD LEX_CB_IN_FIRST[EDI],EBX
	LEA	EAX,DWORD CB_STRUCT_SIZE[EBX]
	MOV	DWORD LEX_CB_IN_END[EDI],EAX
	LEA	EBX,DWORD CB_DATA[EBX]
	MOV	DWORD LEX_CB_IN_PTR[EDI],EBX
	RET
////**************************PROCEDURE*************************
// IN:	 EDI = LEX STRUCT
	ALIGN	4,0x90
FIXUP_CODE::
//IN: EDI LEX_STRUCT
//DURING:
//    ESI PROGRAM CNTER
// STACK: DATATYPES
	BT	DWORD LEX_FLAGS[EDI],LFf_OPT_TRACE
	JNC	@@1B
	CALL	PUT_ALL_IC
@@1B:	PUSHAD
	PUSH	EDI
	CALL	INIT_CB_IN_PTRS
	MOV	ESI,DWORD LEX_CB_IN_PTR[EDI]
	LEA	ESI,DWORD -IC_STRUCT_SIZE[ESI]
	PUSH	0
FIXUP_MAIN_LOOP::
	ADD	ESI,IC_STRUCT_SIZE
	MOV	EAX,DWORD IC_CODE[ESI]
	AND	EAX,0xFF
	JNZ	@@1
	ADD	ESP,4
	POP	EDI

	BT	DWORD LEX_FLAGS[EDI],LFf_OPT_TRACE
	JNC	@@1A
	CALL	PUT_ALL_IC
@@1A:	POPAD
	RET

@@1:	JMP	DWORD FIXUP_CODE_TABLE[EAX*4]
	ALIGN	4,0x90
FIXUP_CODE_TABLE::
	DD	FCT_NULL;
	DD	FCT_XOR;
	DD	FCT_OR_OR;
	DD	FCT_AND_AND;
	DD	FCT_LESS;
	DD	FCT_GREATER;
	DD	FCT_EQUAL_EQUAL;
	DD	FCT_NOT_EQUAL_TO;
	DD	FCT_GREATER_OR_EQUAL;
	DD	FCT_LESS_OR_EQUAL;
	DD	FCT_ADD;
	DD	FCT_SUB;
	DD	FCT_MUL;
	DD	FCT_DIV;
	DD	FCT_MOD;
	DD	FCT_UNARY_MINUS;
	DD	FCT_NOT;
	DD	FCT_INT;
	DD	FCT_DOUBLE;
	DD	FCT_LOCAL_FRAME_PTR;
	DD	0;
	DD	FCT_CALL;
	DD	FCT_RET;
	DD	FCT_INC;
	DD	FCT_DEC;
	DD	FCT_INT8;
	DD	FCT_ADD32;
	DD	FCT_SUB32;
	DD	FCT_ADD8;
	DD	FCT_SUB8;
	DD	FCT_MUL32;
	DD	FCT_DIV32;
	DD	FCT_MUL8;
	DD	FCT_DIV8;
	DD	FCT_ASSIGN32;
	DD	FCT_ASSIGN16;
	DD	FCT_ASSIGN8;
	DD	FCT_ADD_ESP;
	DD	FCT_NOP;
	DD	FCT_OR;
	DD	FCT_AND;
	DD	FCT_SHL;
	DD	FCT_SHR;
	DD	FCT_COM;
	DD	FCT_IRQ;
	DD	FCT_LABEL;
	DD	FCT_SKIPZ;
	DD	FCT_UNUSED2;
	DD	FCT_DEREFERRENCE64;
	DD	FCT_DEREFERRENCE32;
	DD	FCT_DEREFERRENCE16;
	DD	FCT_DEREFERRENCE8;
	DD	FCT_DWORD_PP;
	DD	FCT_WORD_PP;
	DD	FCT_BYTE_PP;
	DD	0;
	DD	0;
	DD	FCT_DWORD_MM;
	DD	FCT_WORD_MM;
	DD	FCT_BYTE_MM;
	DD	0;
	DD	0;
	DD	FCT_ADDRESS;
	DD	FCT_FS;
	DD	FCT_CLI;
	DD	FCT_STI;
	DD	FCT_GET_FLAGS;
	DD	FCT_SET_FLAGS;
	DD	FCT_BT;
	DD	FCT_BTS;
	DD	FCT_BTR;
	DD	FCT_INSQUE;
	DD	FCT_INSQUE_REV;
	DD	FCT_REMQUE;
	DD	FCT_INP;
	DD	FCT_OUTP;
	DD	FCT_REP_INSB;
	DD	FCT_REP_INSW;
	DD	FCT_REP_OUTSB;
	DD	FCT_REP_OUTSW;
	DD	FCT_MEMCPY;
	DD	FCT_MEMSET;
	DD	FCT_INPW;
	DD	FCT_OUTPW;
	DD	FCT_PP_DWORD;
	DD	FCT_PP_WORD;
	DD	FCT_PP_BYTE;
	DD	0;
	DD	0;
	DD	FCT_MM_DWORD;
	DD	FCT_MM_WORD;
	DD	FCT_MM_BYTE;
	DD	0;
	DD	0;
	DD	FCT_INPD;
	DD	FCT_OUTPD;
	DD	FCT_ENTER;
	DD	FCT_LEAVE;
	DD	FCT_TYPE;
	DD	FCT_DS;
	DD	FCT_ADD_ESP8;
	DD	FCT_DWORD_DISP32;
	DD	FCT_WORD_DISP32;
	DD	FCT_BYTE_DISP32;
	DD	FCT_DWORD_DISP8;
	DD	FCT_WORD_DISP8;
	DD	FCT_BYTE_DISP8;
	DD	FCT_CALL_INDIRECT;
	DD	FCT_BTC;
	DD	FCT_QUESTION;
	DD	FCT_COLON;
	DD	FCT_SKIPNZ;
	DD	FCT_STRING_CONSTANT;
	DD	FCT_CALL_INDIRECT2;
	DD	FCT_GET_STACK_PTR;
	DD	FCT_SET_STACK_PTR;
	DD	FCT_GET_LABEL;
	DD	FCT_GET_BASE_PTR;
	DD	FCT_SET_BASE_PTR;
	DD	FCT_ABSOLUTE_ADDRESS;
	DD	FCT_SWITCH;
	DD	FCT_OR_OR_SKIPZ;
	DD	FCT_OR_OR_SKIPZ2;
	DD	FCT_OR_OR_SKIPNZ;
	DD	FCT_OR_OR_SKIPNZ2;
	DD	FCT_AND_AND_SKIPZ;
	DD	FCT_AND_AND_SKIPZ2;
	DD	FCT_AND_AND_SKIPNZ;
	DD	FCT_AND_AND_SKIPNZ2;
	DD	FCT_LESS_THAN_SKIPZ;
	DD	FCT_LESS_THAN_SKIPZ2;
	DD	FCT_LESS_THAN_SKIPNZ;
	DD	FCT_LESS_THAN_SKIPNZ2;
	DD	FCT_GREATER_THAN_SKIPZ;
	DD	FCT_GREATER_THAN_SKIPZ2;
	DD	FCT_GREATER_THAN_SKIPNZ;
	DD	FCT_GREATER_THAN_SKIPNZ2;
	DD	FCT_EQUAL_EQUAL_SKIPZ;
	DD	FCT_EQUAL_EQUAL_SKIPZ2;
	DD	FCT_EQUAL_EQUAL_SKIPNZ;
	DD	FCT_EQUAL_EQUAL_SKIPNZ2;
	DD	FCT_NOT_EQUAL_TO_SKIPZ;
	DD	FCT_NOT_EQUAL_TO_SKIPZ2;
	DD	FCT_NOT_EQUAL_TO_SKIPNZ;
	DD	FCT_NOT_EQUAL_TO_SKIPNZ2;
	DD	FCT_GREATER_OR_EQUAL_SKIPZ;
	DD	FCT_GREATER_OR_EQUAL_SKIPZ2;
	DD	FCT_GREATER_OR_EQUAL_SKIPNZ;
	DD	FCT_GREATER_OR_EQUAL_SKIPNZ2;
	DD	FCT_LESS_OR_EQUAL_SKIPZ;
	DD	FCT_LESS_OR_EQUAL_SKIPZ2;
	DD	FCT_LESS_OR_EQUAL_SKIPNZ;
	DD	FCT_LESS_OR_EQUAL_SKIPNZ2;
	DD	FCT_SHORT_JMP;
	DD	FCT_JMP;
	DD	FCT_BSF;
	DD	FCT_BSR;
	DD	FCT_FILD;
	DD	FCT_FISTP;
	DD	FCT_FLD;
	DD	FCT_FSTP;
	DD	FCT_FYL2X;
	DD	FCT_FABS;
	DD	FCT_FCHS;
	DD	FCT_FSIN;
	DD	FCT_FCOS;
	DD	FCT_FPTAN;
	DD	FCT_FPATAN;
	DD	FCT_FSQRT;
	DD	FCT_FMULP;
	DD	FCT_FDIVP;
	DD	FCT_FDIVRP;
	DD	FCT_FADDP;
	DD	FCT_FSUBP;
	DD	FCT_FSUBRP;
	DD	FCT_AND_EQUAL_DWORD;
	DD	FCT_AND_EQUAL_WORD;
	DD	FCT_AND_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	FCT_OR_EQUAL_DWORD;
	DD	FCT_OR_EQUAL_WORD;
	DD	FCT_OR_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	FCT_XOR_EQUAL_DWORD;
	DD	FCT_XOR_EQUAL_WORD;
	DD	FCT_XOR_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	FCT_ADD_EQUAL_DWORD;
	DD	FCT_ADD_EQUAL_WORD;
	DD	FCT_ADD_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	FCT_SUB_EQUAL_DWORD;
	DD	FCT_SUB_EQUAL_WORD;
	DD	FCT_SUB_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	FCT_MUL_EQUAL_DWORD;
	DD	FCT_MUL_EQUAL_WORD;
	DD	FCT_MUL_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	FCT_DIV_EQUAL_DWORD;
	DD	FCT_DIV_EQUAL_WORD;
	DD	FCT_DIV_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	FCT_SHL_EQUAL_DWORD;
	DD	FCT_SHL_EQUAL_WORD;
	DD	FCT_SHL_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	FCT_SHR_EQUAL_DWORD;
	DD	FCT_SHR_EQUAL_WORD;
	DD	FCT_SHR_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	FCT_TABLE_END;
FIXUP_BINARY_OP::
	MOV	EAX,DWORD IC_CLASS[ESI]
	TEST	BYTE C_PTR_CNT[EAX],0xFF
	JNZ	@@1A
	MOV	EAX,DWORD IC_CLASS[EDI]
	MOV	EBX,DWORD IC_CLASS[EDX]
	MOV	ECX,DWORD HTE_USER0[EAX]
	CMP	ECX,DWORD HTE_USER0[EBX]
	JAE	@@1B
	MOV	EAX,EBX
@@1B:	MOV	DWORD IC_CLASS[ESI],EAX

@@1A:	CMP	BYTE IC_CODE[EDI],EC_INT32
	JNZ	@@1
	CMP	BYTE IC_CODE[EDX],EC_INT32
//	  JNZ	  @@1
@@1:	MOV	EAX,DWORD IC_CLASS[ESI]
	BT	DWORD HTE_USER0[EAX],0
	RET	//Z=1 means both const	C=1 means unsigned
FIXUP_BINARY_OP2::
	CMP	BYTE IC_CODE[EDI],EC_INT32
	JE	@@1D
	CMP	BYTE IC_CODE[EDX],EC_INT32
	JNE	@@1E
	XCHG	EDX,EDI
@@1D:	STC
	RET	//C=1 means EDI const
@@1E:	CLC
	RET
FIXUP_BINARY_OP3::
	CMP	BYTE IC_CODE[EDI],EC_INT32
	JNE	@@1F
	STC
	RET	//C=1 means EDI const
@@1F:	CLC
	RET
FIXUP_CHECK_BP_DISP::
	CMP	BYTE IC_CODE[EDI],EC_ADD32
	JNE	@@1G
	LEA	EDX,DWORD -2*IC_STRUCT_SIZE[EDI]
	CMP	BYTE IC_CODE[EDX],EC_LOCAL_FRAME_PTR
	JNE	@@1G
	STC
	RET	//C=1 means has potential
@@1G:	CLC
	RET
FCT_NULL::
FCT_XOR:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@2
	MOV	EAX,DWORD IC_DATA[EDI]
	XOR	EAX,DWORD IC_DATA[EDX]
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@2:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_OR_OR::
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@2
	MOV	EAX,DWORD IC_DATA[EDI]
	OR	EAX,DWORD IC_DATA[EDX]
	JZ	@@3
	MOV	EAX,1
@@3:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@2:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_AND_AND::
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@4
	MOV	EAX,DWORD IC_DATA[EDI]
	AND	EAX,EAX
	JZ	@@5
	MOV	EAX,DWORD IC_DATA[EDX]
	AND	EAX,EAX
	JZ	@@5
	MOV	EAX,1
@@5:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@4:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_LESS:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@6
	JC	@@7A
	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JLE	@@7
	INC	EAX
	JMP	@@7
@@7A:	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JBE	@@7
	INC	EAX
@@7:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@6:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_GREATER:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@8
	JC	@@9A
	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JGE	@@9
	INC	EAX
	JMP	@@9
@@9A:	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JAE	@@9
	INC	EAX
@@9:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@8:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_EQUAL_EQUAL:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@10
	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JNE	@@11
	INC	EAX
@@11:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@10:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_NOT_EQUAL_TO:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@12
	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JE	@@13
	INC	EAX
@@13:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@12:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_GREATER_OR_EQUAL:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@14
	JC	@@15A
	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JG	@@15
	INC	EAX
	JMP	@@15
@@15A:	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JA	@@15
	INC	EAX
@@15:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@14:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_LESS_OR_EQUAL:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@16
	JC	@@17A
	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JL	@@17
	INC	EAX
	JMP	@@17
@@17A:	MOV	EAX,DWORD IC_DATA[EDI]
	CMP	EAX,DWORD IC_DATA[EDX]
	MOV	EAX,0
	JB	@@17
	INC	EAX
@@17:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@16:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_ADD:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@18
	MOV	EAX,DWORD IC_DATA[EDI]
	ADD	EAX,DWORD IC_DATA[EDX]
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
@@18:	CALL	FIXUP_BINARY_OP2
	JNC	@@18A
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	EAX,DWORD IC_DATA[EDI]
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_ADD32
@@18A:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_SUB:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@19
	MOV	EAX,DWORD IC_DATA[EDX]
	SUB	EAX,DWORD IC_DATA[EDI]
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
@@19:	CALL	FIXUP_BINARY_OP3
	JNC	@@19A
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	EAX,DWORD IC_DATA[EDI]
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_SUB32
@@19A:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_MUL:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@20
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
	JC	@@20A
	MOV	EAX,DWORD IC_DATA[EDX]
	IMUL	DWORD IC_DATA[EDI]
	JMP	@@20B
@@20A:	MOV	EAX,DWORD IC_DATA[EDX]
	MUL	DWORD IC_DATA[EDI]

@@20B:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
@@20:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_DIV:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@21
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
	JC	@@21A
	MOV	EAX,DWORD IC_DATA[EDX]
	XOR	EDX,EDX
	OR	EAX,EAX
	JNS	@@21C
	NOT	EDX
@@21C:	IDIV	DWORD IC_DATA[EDI]
	JMP	@@21B
@@21A:	MOV	EAX,DWORD IC_DATA[EDX]
	XOR	EDX,EDX
	DIV	DWORD IC_DATA[EDI]
@@21B:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
@@21:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_MOD:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@22
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
	JC	@@22A
	MOV	EAX,DWORD IC_DATA[EDX]
	XOR	EDX,EDX
	OR	EAX,EAX
	JNS	@@22C
	NOT	EDX
@@22C:	IDIV	DWORD IC_DATA[EDI]
	JMP	@@22B
@@22A:	MOV	EAX,DWORD IC_DATA[EDX]
	XOR	EDX,EDX
	DIV	DWORD IC_DATA[EDI]
@@22B:	MOV	DWORD IC_DATA[ESI],EDX
	MOV	DWORD IC_CODE[ESI],EC_INT32
@@22:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_UNARY_MINUS:
	POP	EDX
	MOV	EBX,DWORD IC_CLASS[EDX]
	MOV	ECX,DWORD HTE_USER0[EBX]
	TEST	ECX,1
	JZ	@@23A
	DEC	ECX	       //Convert to signed
	MOV	EAX,DWORD sys_internal_types[ECX*4]
	MOV	DWORD IC_CLASS[ESI],EAX

@@23A:	CMP	DWORD IC_CODE[EDX],EC_INT32
	JNZ	@@23
	MOV	EAX,DWORD IC_DATA[EDX]
	NEG	EAX
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@23:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_NOT:
	POP	EDX
	CMP	DWORD IC_CODE[EDX],EC_INT32
	JNZ	@@24
	MOV	EAX,DWORD IC_DATA[EDX]
	OR	EAX,EAX
	MOV	EAX,1
	JZ	@@24A
	XOR	EAX,EAX
@@24A:	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@24:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_INT:
FCT_ABSOLUTE_ADDRESS:
FCT_STRING_CONSTANT:
FCT_GET_LABEL:
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_DOUBLE:
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_LOCAL_FRAME_PTR:
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_CALL:
FCT_CALL_INDIRECT:
FCT_CALL_INDIRECT2:
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_RET:
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_INC:
	POP	EDX
	CMP	DWORD IC_CODE[EDX],EC_INT32
	JNZ	@@25
	MOV	EAX,DWORD IC_DATA[EDX]
	INC	EAX
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@25:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_DEC:
	POP	EDX
	CMP	DWORD IC_CODE[EDX],EC_INT32
	JNZ	@@26
	MOV	EAX,DWORD IC_DATA[EDX]
	DEC	EAX
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@26:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_INT8:
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_ADD32:
FCT_SUB32:
FCT_ADD8:
FCT_SUB8:
FCT_MUL32:
FCT_DIV32:
FCT_MUL8:
FCT_DIV8:
//NOT APPLICABLE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_ASSIGN32:
FCT_ASSIGN16:
FCT_ASSIGN8:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_ADD_ESP:
	POP	EDI
	ADD	ESP,DWORD IC_DATA[ESI]
	LEA	EDX,DWORD -IC_STRUCT_SIZE[ESI]
	CMP	DWORD IC_CODE[EDX],EC_ADD_ESP
	JNE	@@27A
	MOV	EAX,DWORD IC_DATA[EDX]
	ADD	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@27A:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_NOP:
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_OR:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@27
	MOV	EAX,DWORD IC_DATA[EDI]
	OR	EAX,DWORD IC_DATA[EDX]
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@27:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_AND:
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@28
	MOV	EAX,DWORD IC_DATA[EDI]
	AND	EAX,DWORD IC_DATA[EDX]
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@28:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_SHL::
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@28
	MOV	ECX,DWORD IC_DATA[EDI]
	MOV	EAX,DWORD IC_DATA[EDX]
	SHL	EAX,CL
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@28:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_SHR::
	POP	EDI
	POP	EDX
	CALL	FIXUP_BINARY_OP
	JNZ	@@29
	MOV	ECX,DWORD IC_DATA[EDI]
	MOV	EAX,DWORD IC_DATA[EDX]
	SHR	EAX,CL
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@29:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_COM:
	POP	EDX
	CMP	DWORD IC_CODE[EDX],EC_INT32
	JNZ	@@30
	MOV	EAX,DWORD IC_DATA[EDX]
	NOT	EAX
	MOV	DWORD IC_DATA[ESI],EAX
	MOV	DWORD IC_CODE[ESI],EC_INT32
	MOV	DWORD IC_CODE[EDX],EC_NOP
@@30:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_SKIPZ:
	POP	EDI
	CMP	DWORD IC_CODE[EDI],EC_ADD_ESP
	JNE	DWORD @@30Z
	CMP	DWORD IC_DATA[EDI],4
	JNE	@@30Z
	LEA	EDX,DWORD -IC_STRUCT_SIZE[EDI]
	MOVZX	EAX,BYTE IC_CODE[EDX]
	CMP	EAX,EC_OR_OR
	JNE	@@30A
	MOV	DWORD IC_CODE[ESI],EC_OR_OR_SKIPZ2
	JMP	@@30Y
@@30A:	CMP	EAX,EC_AND_AND
	JNE	@@30B
	MOV	DWORD IC_CODE[ESI],EC_AND_AND_SKIPZ2
	JMP	@@30Y
@@30B:	CMP	EAX,EC_LESS_THAN
	JNE	@@30C
	MOV	DWORD IC_CODE[ESI],EC_LESS_THAN_SKIPZ2
	JMP	@@30Y
@@30C:	CMP	EAX,EC_GREATER_THAN
	JNE	@@30D
	MOV	DWORD IC_CODE[ESI],EC_GREATER_THAN_SKIPZ2
	JMP	@@30Y
@@30D:	CMP	EAX,EC_EQUAL_EQUAL
	JNE	@@30E
	MOV	DWORD IC_CODE[ESI],EC_EQUAL_EQUAL_SKIPZ2
	JMP	@@30Y
@@30E:	CMP	EAX,EC_NOT_EQUAL_TO
	JNE	@@30F
	MOV	DWORD IC_CODE[ESI],EC_NOT_EQUAL_TO_SKIPZ2
	JMP	@@30Y
@@30F:	CMP	EAX,EC_GREATER_OR_EQUAL
	JNE	@@30G
	MOV	DWORD IC_CODE[ESI],EC_GREATER_OR_EQUAL_SKIPZ2
	JMP	@@30Y
@@30G:	CMP	EAX,EC_LESS_OR_EQUAL
	JNE	@@30Z
	MOV	DWORD IC_CODE[ESI],EC_LESS_OR_EQUAL_SKIPZ2

@@30Y:	MOV	EAX,DWORD IC_CLASS[EDX]
	MOV	DWORD IC_CLASS[ESI],EAX
	MOV	DWORD IC_CODE[EDX],EC_NOP
	MOV	DWORD IC_CODE[EDI],EC_NOP
@@30Z:	PUSH	EDI
	JMP	DWORD FIXUP_MAIN_LOOP

FCT_SKIPNZ:
	POP	EDI
	CMP	DWORD IC_CODE[EDI],EC_ADD_ESP
	JNE	DWORD @@31Z
	CMP	DWORD IC_DATA[EDI],4
	JNE	@@31Z
	LEA	EDX,DWORD -IC_STRUCT_SIZE[EDI]
	MOVZX	EAX,BYTE IC_CODE[EDX]
	CMP	EAX,EC_OR_OR
	JNE	@@31A
	MOV	DWORD IC_CODE[ESI],EC_OR_OR_SKIPNZ2
	JMP	@@31Y
@@31A:	CMP	EAX,EC_AND_AND
	JNE	@@31B
	MOV	DWORD IC_CODE[ESI],EC_AND_AND_SKIPNZ2
	JMP	@@31Y
@@31B:	CMP	EAX,EC_LESS_THAN
	JNE	@@31C
	MOV	DWORD IC_CODE[ESI],EC_LESS_THAN_SKIPNZ2
	JMP	@@31Y
@@31C:	CMP	EAX,EC_GREATER_THAN
	JNE	@@31D
	MOV	DWORD IC_CODE[ESI],EC_GREATER_THAN_SKIPNZ2
	JMP	@@31Y
@@31D:	CMP	EAX,EC_EQUAL_EQUAL
	JNE	@@31E
	MOV	DWORD IC_CODE[ESI],EC_EQUAL_EQUAL_SKIPNZ2
	JMP	@@31Y
@@31E:	CMP	EAX,EC_NOT_EQUAL_TO
	JNE	@@31F
	MOV	DWORD IC_CODE[ESI],EC_NOT_EQUAL_TO_SKIPNZ2
	JMP	@@31Y
@@31F:	CMP	EAX,EC_GREATER_OR_EQUAL
	JNE	@@31G
	MOV	DWORD IC_CODE[ESI],EC_GREATER_OR_EQUAL_SKIPNZ2
	JMP	@@31Y
@@31G:	CMP	EAX,EC_LESS_OR_EQUAL
	JNE	@@31Z
	MOV	DWORD IC_CODE[ESI],EC_LESS_OR_EQUAL_SKIPNZ2

@@31Y:	MOV	EAX,DWORD IC_CLASS[EDX]
	MOV	DWORD IC_CLASS[ESI],EAX
	MOV	DWORD IC_CODE[EDX],EC_NOP
	MOV	DWORD IC_CODE[EDI],EC_NOP
@@31Z:	PUSH	EDI
	JMP	DWORD FIXUP_MAIN_LOOP

FCT_IRQ:
FCT_LABEL:
FCT_UNUSED2:
FCT_SHORT_JMP:
FCT_JMP:
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_SWITCH:
	ADD	ESP,8
	JMP	DWORD FIXUP_MAIN_LOOP

FCT_DEREFERRENCE64:
FCT_DEREFERRENCE32:
	POP	EDI
/* Seems to slow it down
	CALL	FIXUP_CHECK_BP_DISP
	JNC	@@33
	MOV	DWORD IC_CODE[ESI],EC_DWORD_DISP32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
	MOV	EAX,DWORD IC_DATA[EDI]
	MOV	DWORD IC_DATA[ESI],EAX
*/
@@33:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_DEREFERRENCE16:
	POP	EDI
/* Seems to slow it down
	CALL	FIXUP_CHECK_BP_DISP
	JNC	@@32
	MOV	DWORD IC_CODE[ESI],EC_WORD_DISP32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
	MOV	EAX,DWORD IC_DATA[EDI]
	MOV	DWORD IC_DATA[ESI],EAX
*/
@@32:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_DEREFERRENCE8:
	POP	EDI
/* Seems to slow it down
	CALL	FIXUP_CHECK_BP_DISP
	JNC	@@31
	MOV	DWORD IC_CODE[ESI],EC_BYTE_DISP32
	MOV	DWORD IC_CODE[EDI],EC_NOP
	MOV	DWORD IC_CODE[EDX],EC_NOP
	MOV	EAX,DWORD IC_DATA[EDI]
	MOV	DWORD IC_DATA[ESI],EAX
*/
@@31:	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP

FCT_DWORD_PP:
FCT_WORD_PP:
FCT_BYTE_PP:
FCT_DWORD_MM:
FCT_WORD_MM:
FCT_BYTE_MM:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_ADDRESS:
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_FS:
FCT_CLI:
FCT_STI:
FCT_GET_FLAGS:
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_SET_FLAGS:
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_BT:
FCT_BTS:
FCT_BTR:
FCT_INSQUE:
FCT_INSQUE_REV:
	ADD	ESP,8
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_REMQUE:
FCT_INP:
	ADD	ESP,4
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_OUTP:
	ADD	ESP,8
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_REP_INSB:
FCT_REP_INSW:
FCT_REP_OUTSB:
FCT_REP_OUTSW:
FCT_MEMCPY:
FCT_MEMSET:
	ADD	ESP,12
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_INPW:
	ADD	ESP,4
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_OUTPW:
	ADD	ESP,8
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_PP_DWORD:
FCT_PP_WORD:
FCT_PP_BYTE:
FCT_MM_DWORD:
FCT_MM_WORD:
FCT_MM_BYTE:
FCT_BSF:
FCT_BSR:
FCT_INPD:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_OUTPD:
	ADD	ESP,8
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_ENTER:
FCT_LEAVE:
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_TYPE:
	POP	EDX
//	MOV	EAX,DWORD IC_CLASS[EDX]
//	MOV	DWORD IC_DATA[ESI],EAX
	PUSH	EDX
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_DS:
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_ADD_ESP8:
	ADD	ESP,DWORD IC_DATA[ESI]
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_DWORD_DISP32:
FCT_WORD_DISP32:
FCT_BYTE_DISP32:
FCT_DWORD_DISP8:
FCT_WORD_DISP8:
FCT_BYTE_DISP8:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_BTC:
	ADD	ESP,8
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_QUESTION:
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_COLON:
	ADD	ESP,12
	PUSH	ESI
//TODO:--SET TYPE
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_GET_BASE_PTR:
FCT_GET_STACK_PTR:
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_SET_BASE_PTR:
FCT_SET_STACK_PTR:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_OR_OR_SKIPZ:
FCT_OR_OR_SKIPZ2:
FCT_OR_OR_SKIPNZ:
FCT_OR_OR_SKIPNZ2:
FCT_AND_AND_SKIPZ:
FCT_AND_AND_SKIPZ2:
FCT_AND_AND_SKIPNZ:
FCT_AND_AND_SKIPNZ2:
FCT_LESS_THAN_SKIPZ:
FCT_LESS_THAN_SKIPZ2:
FCT_LESS_THAN_SKIPNZ:
FCT_LESS_THAN_SKIPNZ2:
FCT_GREATER_THAN_SKIPZ:
FCT_GREATER_THAN_SKIPZ2:
FCT_GREATER_THAN_SKIPNZ:
FCT_GREATER_THAN_SKIPNZ2:
FCT_EQUAL_EQUAL_SKIPZ:
FCT_EQUAL_EQUAL_SKIPZ2:
FCT_EQUAL_EQUAL_SKIPNZ:
FCT_EQUAL_EQUAL_SKIPNZ2:
FCT_NOT_EQUAL_TO_SKIPZ:
FCT_NOT_EQUAL_TO_SKIPZ2:
FCT_NOT_EQUAL_TO_SKIPNZ:
FCT_NOT_EQUAL_TO_SKIPNZ2:
FCT_GREATER_OR_EQUAL_SKIPZ:
FCT_GREATER_OR_EQUAL_SKIPZ2:
FCT_GREATER_OR_EQUAL_SKIPNZ:
FCT_GREATER_OR_EQUAL_SKIPNZ2:
FCT_LESS_OR_EQUAL_SKIPZ:
FCT_LESS_OR_EQUAL_SKIPZ2:
FCT_LESS_OR_EQUAL_SKIPNZ:
FCT_LESS_OR_EQUAL_SKIPNZ2:
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_FILD:
FCT_FISTP:
FCT_FLD:
FCT_FSTP:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_FYL2X:
FCT_FABS:
FCT_FCHS:
FCT_FSIN:
FCT_FCOS:
FCT_FPTAN:
FCT_FPATAN:
FCT_FSQRT:
FCT_FMULP:
FCT_FDIVP:
FCT_FDIVRP:
FCT_FADDP:
FCT_FSUBP:
FCT_FSUBRP:
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_AND_EQUAL_DWORD:
FCT_AND_EQUAL_WORD:
FCT_AND_EQUAL_BYTE:
FCT_OR_EQUAL_DWORD:
FCT_OR_EQUAL_WORD:
FCT_OR_EQUAL_BYTE:
FCT_XOR_EQUAL_DWORD:
FCT_XOR_EQUAL_WORD:
FCT_XOR_EQUAL_BYTE:
FCT_ADD_EQUAL_DWORD:
FCT_ADD_EQUAL_WORD:
FCT_ADD_EQUAL_BYTE:
FCT_SUB_EQUAL_DWORD:
FCT_SUB_EQUAL_WORD:
FCT_SUB_EQUAL_BYTE:
FCT_MUL_EQUAL_DWORD:
FCT_MUL_EQUAL_WORD:
FCT_MUL_EQUAL_BYTE:
FCT_DIV_EQUAL_DWORD:
FCT_DIV_EQUAL_WORD:
FCT_DIV_EQUAL_BYTE:
FCT_SHL_EQUAL_DWORD:
FCT_SHL_EQUAL_WORD:
FCT_SHL_EQUAL_BYTE:
FCT_SHR_EQUAL_DWORD:
FCT_SHR_EQUAL_WORD:
FCT_SHR_EQUAL_BYTE:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD FIXUP_MAIN_LOOP
FCT_TABLE_END:

////**************************PROCEDURE*************************
// IN:	 EDI = LEX STRUCT
// OUT:  CARRY CLEAR MEANS NO OPT FOUND
	ALIGN	4,0x90
OPTIMIZE_CODE::
//IN: EDI LEX_STRUCT
//DURING:
//    ESI PROGRAM CNTER
// STACK: DATATYPES
	PUSHAD
	PUSH	EDI
	CALL	INIT_CB_IN_PTRS
	MOV	ESI,DWORD LEX_CB_IN_PTR[EDI]
	LEA	ESI,DWORD -IC_STRUCT_SIZE[ESI]
	PUSH	0
OPT_MAIN_LOOP::
	ADD	ESI,IC_STRUCT_SIZE
	MOV	EAX,DWORD IC_CODE[ESI]
	AND	EAX,0xFF
	JNZ	@@1
	ADD	ESP,4
	POP	EDI

	BT	DWORD LEX_FLAGS[EDI],LFf_OPT_TRACE
	JNC	@@1A
	CALL	PUT_ALL_IC
@@1A:	POPAD
	CLC
	RET

@@1:	JMP	DWORD OPT_CODE_TABLE[EAX*4]
	ALIGN	4,0x90
OPT_CODE_TABLE::
	DD	OCT_NULL;
	DD	OCT_XOR;
	DD	OCT_OR_OR;
	DD	OCT_AND_AND;
	DD	OCT_LESS;
	DD	OCT_GREATER;
	DD	OCT_EQUAL_EQUAL;
	DD	OCT_NOT_EQUAL_TO;
	DD	OCT_GREATER_OR_EQUAL;
	DD	OCT_LESS_OR_EQUAL;
	DD	OCT_ADD;
	DD	OCT_SUB;
	DD	OCT_MUL;
	DD	OCT_DIV;
	DD	OCT_MOD;
	DD	OCT_UNARY_MINUS;
	DD	OCT_NOT;
	DD	OCT_INT;
	DD	OCT_DOUBLE;
	DD	OCT_LOCAL_FRAME_PTR;
	DD	0;
	DD	OCT_CALL;
	DD	OCT_RET;
	DD	OCT_INC;
	DD	OCT_DEC;
	DD	OCT_INT8;
	DD	OCT_ADD32;
	DD	OCT_SUB32;
	DD	OCT_ADD8;
	DD	OCT_SUB8;
	DD	OCT_MUL32;
	DD	OCT_DIV32;
	DD	OCT_MUL8;
	DD	OCT_DIV8;
	DD	OCT_ASSIGN32;
	DD	OCT_ASSIGN16;
	DD	OCT_ASSIGN8;
	DD	OCT_ADD_ESP;
	DD	OCT_NOP;
	DD	OCT_OR;
	DD	OCT_AND;
	DD	OCT_SHL;
	DD	OCT_SHR;
	DD	OCT_COM;
	DD	OCT_IRQ;
	DD	OCT_LABEL;
	DD	OCT_SKIPZ;
	DD	OCT_UNUSED2;
	DD	OCT_DEREFERRENCE64;
	DD	OCT_DEREFERRENCE32;
	DD	OCT_DEREFERRENCE16;
	DD	OCT_DEREFERRENCE8;
	DD	OCT_DWORD_PP;
	DD	OCT_WORD_PP;
	DD	OCT_BYTE_PP;
	DD	0;
	DD	0;
	DD	OCT_DWORD_MM;
	DD	OCT_WORD_MM;
	DD	OCT_BYTE_MM;
	DD	0;
	DD	0;
	DD	OCT_ADDRESS;
	DD	OCT_FS;
	DD	OCT_CLI;
	DD	OCT_STI;
	DD	OCT_GET_FLAGS;
	DD	OCT_SET_FLAGS;
	DD	OCT_BT;
	DD	OCT_BTS;
	DD	OCT_BTR;
	DD	OCT_INSQUE;
	DD	OCT_INSQUE_REV;
	DD	OCT_REMQUE;
	DD	OCT_INP;
	DD	OCT_OUTP;
	DD	OCT_REP_INSB;
	DD	OCT_REP_INSW;
	DD	OCT_REP_OUTSB;
	DD	OCT_REP_OUTSW;
	DD	OCT_MEMCPY;
	DD	OCT_MEMSET;
	DD	OCT_INPW;
	DD	OCT_OUTPW;
	DD	OCT_PP_DWORD;
	DD	OCT_PP_WORD;
	DD	OCT_PP_BYTE;
	DD	0;
	DD	0;
	DD	OCT_MM_DWORD;
	DD	OCT_MM_WORD;
	DD	OCT_MM_BYTE;
	DD	0;
	DD	0;
	DD	OCT_INPD;
	DD	OCT_OUTPD;
	DD	OCT_ENTER;
	DD	OCT_LEAVE;
	DD	OCT_TYPE;
	DD	OCT_DS;
	DD	OCT_ADD_ESP8;
	DD	OCT_DWORD_DISP32;
	DD	OCT_WORD_DISP32;
	DD	OCT_BYTE_DISP32;
	DD	OCT_DWORD_DISP8;
	DD	OCT_WORD_DISP8;
	DD	OCT_BYTE_DISP8;
	DD	OCT_CALL_INDIRECT;
	DD	OCT_BTC;
	DD	OCT_QUESTION;
	DD	OCT_COLON;
	DD	OCT_SKIPNZ;
	DD	OCT_STRING_CONSTANT;
	DD	OCT_CALL_INDIRECT2;
	DD	OCT_GET_STACK_PTR;
	DD	OCT_SET_STACK_PTR;
	DD	OCT_GET_LABEL;
	DD	OCT_GET_BASE_PTR;
	DD	OCT_SET_BASE_PTR;
	DD	OCT_ABSOLUTE_ADDRESS;
	DD	OCT_SWITCH;
	DD	OCT_OR_OR_SKIPZ;
	DD	OCT_OR_OR_SKIPZ2;
	DD	OCT_OR_OR_SKIPNZ;
	DD	OCT_OR_OR_SKIPNZ2;
	DD	OCT_AND_AND_SKIPZ;
	DD	OCT_AND_AND_SKIPZ2;
	DD	OCT_AND_AND_SKIPNZ;
	DD	OCT_AND_AND_SKIPNZ2;
	DD	OCT_LESS_THAN_SKIPZ;
	DD	OCT_LESS_THAN_SKIPZ2;
	DD	OCT_LESS_THAN_SKIPNZ;
	DD	OCT_LESS_THAN_SKIPNZ2;
	DD	OCT_GREATER_THAN_SKIPZ;
	DD	OCT_GREATER_THAN_SKIPZ2;
	DD	OCT_GREATER_THAN_SKIPNZ;
	DD	OCT_GREATER_THAN_SKIPNZ2;
	DD	OCT_EQUAL_EQUAL_SKIPZ;
	DD	OCT_EQUAL_EQUAL_SKIPZ2;
	DD	OCT_EQUAL_EQUAL_SKIPNZ;
	DD	OCT_EQUAL_EQUAL_SKIPNZ2;
	DD	OCT_NOT_EQUAL_TO_SKIPZ;
	DD	OCT_NOT_EQUAL_TO_SKIPZ2;
	DD	OCT_NOT_EQUAL_TO_SKIPNZ;
	DD	OCT_NOT_EQUAL_TO_SKIPNZ2;
	DD	OCT_GREATER_OR_EQUAL_SKIPZ;
	DD	OCT_GREATER_OR_EQUAL_SKIPZ2;
	DD	OCT_GREATER_OR_EQUAL_SKIPNZ;
	DD	OCT_GREATER_OR_EQUAL_SKIPNZ2;
	DD	OCT_LESS_OR_EQUAL_SKIPZ;
	DD	OCT_LESS_OR_EQUAL_SKIPZ2;
	DD	OCT_LESS_OR_EQUAL_SKIPNZ;
	DD	OCT_LESS_OR_EQUAL_SKIPNZ2;
	DD	OCT_SHORT_JMP;
	DD	OCT_JMP;
	DD	OCT_BSF;
	DD	OCT_BSR;
	DD	OCT_FILD;
	DD	OCT_FISTP;
	DD	OCT_FLD;
	DD	OCT_FSTP;
	DD	OCT_FYL2X;
	DD	OCT_FABS;
	DD	OCT_FCHS;
	DD	OCT_FSIN;
	DD	OCT_FCOS;
	DD	OCT_FPTAN;
	DD	OCT_FPATAN;
	DD	OCT_FSQRT;
	DD	OCT_FMULP;
	DD	OCT_FDIVP;
	DD	OCT_FDIVRP;
	DD	OCT_FADDP;
	DD	OCT_FSUBP;
	DD	OCT_FSUBRP;
	DD	OCT_AND_EQUAL_DWORD;
	DD	OCT_AND_EQUAL_WORD;
	DD	OCT_AND_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	OCT_OR_EQUAL_DWORD;
	DD	OCT_OR_EQUAL_WORD;
	DD	OCT_OR_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	OCT_XOR_EQUAL_DWORD;
	DD	OCT_XOR_EQUAL_WORD;
	DD	OCT_XOR_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	OCT_ADD_EQUAL_DWORD;
	DD	OCT_ADD_EQUAL_WORD;
	DD	OCT_ADD_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	OCT_SUB_EQUAL_DWORD;
	DD	OCT_SUB_EQUAL_WORD;
	DD	OCT_SUB_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	OCT_MUL_EQUAL_DWORD;
	DD	OCT_MUL_EQUAL_WORD;
	DD	OCT_MUL_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	OCT_DIV_EQUAL_DWORD;
	DD	OCT_DIV_EQUAL_WORD;
	DD	OCT_DIV_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	OCT_SHL_EQUAL_DWORD;
	DD	OCT_SHL_EQUAL_WORD;
	DD	OCT_SHL_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	OCT_SHR_EQUAL_DWORD;
	DD	OCT_SHR_EQUAL_WORD;
	DD	OCT_SHR_EQUAL_BYTE;
	DD	0;
	DD	0;
	DD	OCT_TABLE_END;
OCT_NULL:
OCT_XOR:
OCT_OR_OR:
OCT_AND_AND:
OCT_LESS:
OCT_GREATER:
OCT_EQUAL_EQUAL:
OCT_NOT_EQUAL_TO:
OCT_GREATER_OR_EQUAL:
OCT_LESS_OR_EQUAL:
OCT_ADD:
OCT_SUB:
OCT_MUL:
OCT_DIV:
OCT_MOD:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_UNARY_MINUS:
OCT_NOT:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_INT:
OCT_STRING_CONSTANT:
OCT_ABSOLUTE_ADDRESS:
OCT_GET_LABEL:
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_DOUBLE:
	JMP	DWORD OPT_MAIN_LOOP
OCT_LOCAL_FRAME_PTR:
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_CALL:
OCT_CALL_INDIRECT:
OCT_CALL_INDIRECT2:
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_RET:
	JMP	DWORD OPT_MAIN_LOOP
OCT_INC:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_DEC:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_INT8:
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_ADD32:
	POP	EDI
	MOV	EAX,DWORD IC_DATA[ESI]
	OR	EAX,EAX 	//CHeck +0
	JNZ	@@26C
	MOV	EAX,DWORD IC_CLASS[ESI]
	MOV	DWORD IC_CLASS[EDI],EAX
	MOV	DWORD IC_CODE[ESI],EC_NOP
	PUSH	EDI
	JMP	DWORD OPT_MAIN_LOOP

@@26C:	CMP	EAX,1
	JNE	@@26D
	MOV	DWORD IC_CODE[ESI],EC_INC
	JMP	@@26A
@@26D:	CMP	EAX,0xFFFFFFFF
	JNE	@@26E
	MOV	DWORD IC_CODE[ESI],EC_DEC
	JMP	@@26A

@@26E:	CMP	EAX,0x7F
	JG	@@26A
	CMP	EAX,0xFFFFFF80
	JL	@@26A
	MOV	DWORD IC_CODE[ESI],EC_ADD8
@@26A:	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_SUB32:
	POP	EDI
	MOV	EAX,DWORD IC_DATA[ESI]
	OR	EAX,EAX 	//CHeck +0
	JNZ	@@26F
	MOV	EAX,DWORD IC_CLASS[ESI]
	MOV	DWORD IC_CLASS[EDI],EAX
	MOV	DWORD IC_CODE[ESI],EC_NOP
	PUSH	EDI
	JMP	DWORD OPT_MAIN_LOOP

@@26F:	CMP	EAX,1
	JNE	@@26G
	MOV	DWORD IC_CODE[ESI],EC_DEC
	JMP	@@26B
@@26G:	CMP	EAX,0xFFFFFFFF
	JNE	@@26H
	MOV	DWORD IC_CODE[ESI],EC_DEC
	JMP	@@26B

@@26H:	CMP	EAX,0x7F
	JG	@@26B
	CMP	EAX,0xFFFFFF80
	JL	@@26B
	MOV	DWORD IC_CODE[ESI],EC_SUB8
@@26B:	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_ADD8:
//NOT APPLICABLE
	JMP	DWORD OPT_MAIN_LOOP
OCT_SUB8:
//NOT APPLICABLE
	JMP	DWORD OPT_MAIN_LOOP
OCT_MUL32:
//NOT APPLICABLE
	JMP	DWORD OPT_MAIN_LOOP
OCT_DIV32:
//NOT APPLICABLE
	JMP	DWORD OPT_MAIN_LOOP
OCT_MUL8:
//NOT APPLICABLE
	JMP	DWORD OPT_MAIN_LOOP
OCT_DIV8:
//NOT APPLICABLE
	JMP	DWORD OPT_MAIN_LOOP
OCT_ASSIGN32:
OCT_ASSIGN16:
OCT_ASSIGN8:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_ADD_ESP:
	MOV	EAX,DWORD IC_DATA[ESI]
	ADD	ESP,EAX
	CMP	EAX,0x7F
	JG	@@27A
	CMP	EAX,0xFFFFFF80
	JL	@@27A
	MOV	DWORD IC_CODE[ESI],EC_ADD_ESP8
@@27A:	JMP	DWORD OPT_MAIN_LOOP
OCT_NOP:
	JMP	DWORD OPT_MAIN_LOOP
OCT_OR:
OCT_AND:
OCT_SHL:
OCT_SHR:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_COM:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_IRQ:
	JMP	DWORD OPT_MAIN_LOOP
OCT_LABEL:
	JMP	DWORD OPT_MAIN_LOOP
OCT_SKIPZ:
OCT_SKIPNZ:
	JMP	DWORD OPT_MAIN_LOOP
OCT_UNUSED2:
OCT_SHORT_JMP:
OCT_JMP:
	JMP	DWORD OPT_MAIN_LOOP
OCT_SWITCH:
	ADD	ESP,8
	JMP	DWORD OPT_MAIN_LOOP

OCT_DEREFERRENCE64:
OCT_DEREFERRENCE32:
OCT_DEREFERRENCE16:
OCT_DEREFERRENCE8:
OCT_DWORD_PP:
OCT_WORD_PP:
OCT_BYTE_PP:
OCT_short_PP:
OCT_char_PP:
OCT_DWORD_MM:
OCT_WORD_MM:
OCT_BYTE_MM:
OCT_short_MM:
OCT_char_MM:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_ADDRESS:
	JMP	DWORD OPT_MAIN_LOOP
OCT_FS:
OCT_CLI:
OCT_STI:
OCT_GET_FLAGS:
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_SET_FLAGS:
	JMP	DWORD OPT_MAIN_LOOP
OCT_BT:
OCT_BTS:
OCT_BTR:
OCT_INSQUE:
OCT_INSQUE_REV:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_REMQUE:
OCT_INP:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_OUTP:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_REP_INSB:
OCT_REP_INSW:
OCT_REP_OUTSB:
OCT_REP_OUTSW:
OCT_MEMCPY:
OCT_MEMSET:
	ADD	ESP,12
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_INPW:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_OUTPW:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_PP_DWORD:
OCT_PP_WORD:
OCT_PP_BYTE:
OCT_PP_short:
OCT_PP_char:
OCT_MM_DWORD:
OCT_MM_WORD:
OCT_MM_BYTE:
OCT_MM_short:
OCT_MM_char:
OCT_BSF:
OCT_BSR:
OCT_INPD:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_OUTPD:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_ENTER:
	JMP	DWORD OPT_MAIN_LOOP
OCT_LEAVE:
	JMP	DWORD OPT_MAIN_LOOP
OCT_TYPE:
OCT_DS:
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_ADD_ESP8:
	ADD	ESP,DWORD IC_DATA[ESI]
	JMP	DWORD OPT_MAIN_LOOP
OCT_DWORD_DISP32:
	MOV	EAX,DWORD IC_DATA[ESI]
	CMP	EAX,0x7F
	JG	@@31
	CMP	EAX,0xFFFFFF80
	JL	@@31
	MOV	DWORD IC_CODE[ESI],EC_DWORD_DISP8
@@31:	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_WORD_DISP32:
	MOV	EAX,DWORD IC_DATA[ESI]
	CMP	EAX,0x7F
	JG	@@32
	CMP	EAX,0xFFFFFF80
	JL	@@32
	MOV	DWORD IC_CODE[ESI],EC_WORD_DISP8
@@32:	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_BYTE_DISP32:
	MOV	EAX,DWORD IC_DATA[ESI]
	CMP	EAX,0x7F
	JG	@@33
	CMP	EAX,0xFFFFFF80
	JL	@@33
	MOV	DWORD IC_CODE[ESI],EC_BYTE_DISP8
@@33:	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_DWORD_DISP8:
OCT_WORD_DISP8:
OCT_BYTE_DISP8:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_BTC:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_QUESTION:
	JMP	DWORD OPT_MAIN_LOOP
OCT_COLON:
	ADD	ESP,12
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_GET_BASE_PTR:
OCT_GET_STACK_PTR:
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_SET_BASE_PTR:
OCT_SET_STACK_PTR:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_OR_OR_SKIPZ:
OCT_OR_OR_SKIPZ2:
OCT_OR_OR_SKIPNZ:
OCT_OR_OR_SKIPNZ2:
OCT_AND_AND_SKIPZ:
OCT_AND_AND_SKIPZ2:
OCT_AND_AND_SKIPNZ:
OCT_AND_AND_SKIPNZ2:
OCT_LESS_THAN_SKIPZ:
OCT_LESS_THAN_SKIPZ2:
OCT_LESS_THAN_SKIPNZ:
OCT_LESS_THAN_SKIPNZ2:
OCT_GREATER_THAN_SKIPZ:
OCT_GREATER_THAN_SKIPZ2:
OCT_GREATER_THAN_SKIPNZ:
OCT_GREATER_THAN_SKIPNZ2:
OCT_EQUAL_EQUAL_SKIPZ:
OCT_EQUAL_EQUAL_SKIPZ2:
OCT_EQUAL_EQUAL_SKIPNZ:
OCT_EQUAL_EQUAL_SKIPNZ2:
OCT_NOT_EQUAL_TO_SKIPZ:
OCT_NOT_EQUAL_TO_SKIPZ2:
OCT_NOT_EQUAL_TO_SKIPNZ:
OCT_NOT_EQUAL_TO_SKIPNZ2:
OCT_GREATER_OR_EQUAL_SKIPZ:
OCT_GREATER_OR_EQUAL_SKIPZ2:
OCT_GREATER_OR_EQUAL_SKIPNZ:
OCT_GREATER_OR_EQUAL_SKIPNZ2:
OCT_LESS_OR_EQUAL_SKIPZ:
OCT_LESS_OR_EQUAL_SKIPZ2:
OCT_LESS_OR_EQUAL_SKIPNZ:
OCT_LESS_OR_EQUAL_SKIPNZ2:
	ADD	ESP,12
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_FILD:
OCT_FISTP:
OCT_FLD:
OCT_FSTP:
	ADD	ESP,4
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_FYL2X:
OCT_FABS:
OCT_FCHS:
OCT_FSIN:
OCT_FCOS:
OCT_FPTAN:
OCT_FPATAN:
OCT_FSQRT:
OCT_FMULP:
OCT_FDIVP:
OCT_FDIVRP:
OCT_FADDP:
OCT_FSUBP:
OCT_FSUBRP:
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_AND_EQUAL_DWORD:
OCT_AND_EQUAL_WORD:
OCT_AND_EQUAL_BYTE:
OCT_AND_EQUAL_short:
OCT_AND_EQUAL_char:
OCT_OR_EQUAL_DWORD:
OCT_OR_EQUAL_WORD:
OCT_OR_EQUAL_BYTE:
OCT_OR_EQUAL_short:
OCT_OR_EQUAL_char:
OCT_XOR_EQUAL_DWORD:
OCT_XOR_EQUAL_WORD:
OCT_XOR_EQUAL_BYTE:
OCT_XOR_EQUAL_short:
OCT_XOR_EQUAL_char:
OCT_ADD_EQUAL_DWORD:
OCT_ADD_EQUAL_WORD:
OCT_ADD_EQUAL_BYTE:
OCT_ADD_EQUAL_short:
OCT_ADD_EQUAL_char:
OCT_SUB_EQUAL_DWORD:
OCT_SUB_EQUAL_WORD:
OCT_SUB_EQUAL_BYTE:
OCT_SUB_EQUAL_short:
OCT_SUB_EQUAL_char:
OCT_MUL_EQUAL_DWORD:
OCT_MUL_EQUAL_WORD:
OCT_MUL_EQUAL_BYTE:
OCT_MUL_EQUAL_short:
OCT_MUL_EQUAL_char:
OCT_DIV_EQUAL_DWORD:
OCT_DIV_EQUAL_WORD:
OCT_DIV_EQUAL_BYTE:
OCT_DIV_EQUAL_short:
OCT_DIV_EQUAL_char:
OCT_SHL_EQUAL_DWORD:
OCT_SHL_EQUAL_WORD:
OCT_SHL_EQUAL_BYTE:
OCT_SHL_EQUAL_short:
OCT_SHL_EQUAL_char:
OCT_SHR_EQUAL_DWORD:
OCT_SHR_EQUAL_WORD:
OCT_SHR_EQUAL_BYTE:
OCT_SHR_EQUAL_short:
OCT_SHR_EQUAL_char:
	ADD	ESP,8
	PUSH	ESI
	JMP	DWORD OPT_MAIN_LOOP
OCT_TABLE_END:


CP_FIXUP_CODE::
	PUSH	EBP
	MOV	EBP,ESP
	PUSHAD
	MOV	EDI,DWORD SF_PARAM1[EBP]
	CALL	FIXUP_CODE
	POPAD
	POP	EBP
	RET

CP_OPTIMIZE_CODE::
	PUSH	EBP
	MOV	EBP,ESP
	PUSHAD
	MOV	EDI,DWORD SF_PARAM1[EBP]
	CALL	OPTIMIZE_CODE
	POPAD
	POP	EBP
	RET
